#!/bin/bash
usage() {
    progname=$(basename $0)
    cat <<EOF
usage: $progname [EXT]
Use fzf to select and open a file with xdg-open
Optionally only search files with the given extension
EOF
}

# find_files DIR [EXT]
find_files() {
    echo "$2"
    if [[ -n $2 ]]; then
        find "$1" -type f -name "*.$2"
    else
        find "$1" -type f
    fi
}

if [[ $1 == "-h" || $1 == "--help" ]]; then
    usage
    exit 0
fi

dir="$HOME"
ext="$1"

f=$(find_files "$dir" "$ext" | fzf)
if [[ -z $f ]]; then
    echo "no file selected" >&2
    exit 1
fi
xdg-open "$f" 1>/dev/null 2>&1
